<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/><meta content="telephone=no" name="format-detection"/><meta name="description"/><title>有关C语言的闲聊 | Zen</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"/><link rel="stylesheet" type="text/css" href="/css/pure-min.css"/><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"/><link rel="stylesheet" type="text/css" href="/css/style.css"/><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"/><link rel="alternate" type="application/atom+xml" href="/atom.xml"/></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">有关C语言的闲聊</h1><a id="logo" href="/">Zen</a><p class="description">craft‘s note</p></div><div id="nav-menu"><a href="/" class="current"><i class="icon-home"> Home</i></a><a href="/archives/"><i class="icon-archive"> Archive</i></a><a href="/atom.xml"><i class="icon-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">有关C语言的闲聊</h1><div class="post-meta">2016-02-07 | </div><span data-thread-key="2016/02/07/有关C语言的闲聊/" class="ds-thread-count"></span><div class="post-content"><p>最近读k&amp;r c和其他C语言书籍的一些感想：</p>
<p>C是工程师在开发现场基于具体的开发目标而发明的语言。<br>它强大有力，赋予程序员非常大的权力和自由，但并不强调优美，统一，安全，健壮等在年轻的后进语言宣传语中经常听到的概念。</p>
<p>C的指针基本沿袭自B。在B语言中，指针和普通的整型没有本质区别，因而指针和整型的加减运算十分自然合理；然而在C语言中，引入了很多数据类型，情况变得复杂得多，指针的运算显得复杂晦涩，给初学者造成了许多障碍。<br>将C的指针简单地理解成内存地址并不十分合适，更恰当的理解应该是：指针的值为一个内存地址，而指针类型则可以表明指针所指向的内存块的大小，对指针+1操作，地址的增量并非1而取决于指针指向的引用类型的大小。</p>
<p>C语言的语法非常不统一。以声明语法为例，初学者往往会误以为其遵循<code>变量类型 变量名;</code>这样的形式，如<code>int a_num;</code>。<br>但对指针类型的声明，形如<code>int *p;</code>,并未遵从此形式：<code>int*</code>不是变量类型，倘若它是则<code>int* p1, p2;</code>就不会导致歧义。<br>对此我的理解是，声明中出现的操作符并不具有与表达式中等同的语义，仅仅用来构成一定形式以表示某种数据类型。<br>例如<code>int arr[5];</code>声明了一个包含5个元素的整型数组，而在表达式中<code>arr[5]</code>意为<code>*(arr+5)</code>（或者也可以表示为<code>*(&amp;arr[0]+5)</code>）。</p>
<p>滥用C语言提供了一些语言特性很可能降低程序的可读性，甚至引入一些难以调试的隐性 bug。<br>例如老生常谈的自增自减运算符问题:<br>对变量增1减1确实是个使用场合非常多的操作，但++和–操作隐藏了赋值操作的副作用，如果表达式和语句中涉及对此变量的多处引用，则不适宜使用此类操作符。<br>为了追求短小紧凑，C程序经常试图将多个表达式/语句表示的语句压缩到一个表达式中，但C标准并没有严格定义表达式的求值顺序（只规定了操作符的求值顺序，以及副作用必须在某些语义结束点前发生，但语义结束点前副作用的顺序没有严格定义，这样编译器能获得更大的自由，从而在理论上可能进行更好的性能优化），因此i+++i++这类表达式的值属于未定义值，具体是多少有赖于编译器的实现。<br>k&amp;r c中专门强调了这个问题：</p>
<blockquote>
<p>The moral is that writing code that depends on order of evaluation is a bad programming practice in any language.</p>
</blockquote>
<p>即使程序的语义不依赖某个未定义数值，依然不推荐这样的写法，因为会大大增加维护的困难。</p>
<p>C程序有时会鼓励一些略显hack的写法。<br>例如k&amp;r c的例程：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">This loop prints n elements of an array, 10 per line,</span><br><span class="line">with each column separated by one blank,</span><br><span class="line">and with each line (including the last) terminated by a newline.</span><br><span class="line">*/</span><br><span class="line">for (i = 0; i &lt; n; i++)</span><br><span class="line">    printf("%6d%c", a[i], (i%10==9 || i==n-1) ? '\n' : '');</span><br></pre></td></tr></table></figure></p>
<p>如果不借助注释很难一眼看懂代码(可能是我太弱:))。<br>考虑到C语言诞生的年代：电脑性能还十分低下，内存尚且非常昂贵，这种做法并不足以为奇。在单行代码中使用不是那么一目了然的紧凑写法其实并不会导致额外的维护工作，但却需要程序员之间建立一些不言而喻的约定俗成。<br>这种哲学如果推及其他语言并不一定合乎时宜，但以性能和紧凑未追求的C语言有充分的理由坚持。</p>
<p>总的来说，由于历史原因，C语言是一门不怎么严格的语言，对程序员提出了比较高的要求。C语言许多能算得上问题的问题，经常是面对具体问题的折中和权衡。诚然，你需要克服许多看起来不是很必要的困难，但你因此变得更强大:)。</p>
</div><div class="tags"><a href="/tags/C/">C</a></div><div class="post-nav"><a href="/2016/01/21/igcc-REPL-for-c-c/" class="next">igcc:c/c++解释器<i class="icon-next"></i></a></div><div data-thread-key="2016/02/07/有关C语言的闲聊/" data-title="有关C语言的闲聊" data-url="http://yoursite.com/2016/02/07/有关C语言的闲聊/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/02/07/有关C语言的闲聊/" data-title="有关C语言的闲聊" data-url="http://yoursite.com/2016/02/07/有关C语言的闲聊/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title">Categories</div></div><div class="widget"><div class="widget-title">Tags</div><div class="tagcloud"><a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/C/" style="font-size: 15px;">C</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/c-c/" style="font-size: 15px;">c/c++</a></div></div><div class="widget"><div class="widget-title">Recent</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/02/07/有关C语言的闲聊/">有关C语言的闲聊</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/21/igcc-REPL-for-c-c/">igcc:c/c++解释器</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/29/使用nginx和nginx-rtmp搭建流媒体服务器/">使用 nginx 和 nginx-rtmp 搭建流媒体服务器</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/27/Google-JS-代码风格指南（5）/">Google JS 代码风格指南（5）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/27/Google-JS-代码风格指南（4）/">Google JS 代码风格指南（4）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/27/Google-JS-代码风格指南（3）/">Google JS 代码风格指南（3）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/27/Google-JS-代码风格指南（2）/">Google JS 代码风格指南（2）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/27/Google-JS-代码风格指南（1）/">Google JS 代码风格指南（1）</a></li></ul></div><div class="widget"><div class="comments-title">Recent Comments</div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title">Blogroll</div><ul></ul><a href="https://www.zhihu.com/people/craftman" title="知乎" target="_blank">知乎</a><ul></ul><a href="http://www.douban.com/people/craftman/" title="豆瓣" target="_blank">豆瓣</a></div></div></div></div><div id="footer">© <a href="/" rel="nofollow">Zen.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/totop.js" type="text/javascript"></script><script src="/js/fancybox.pack.js" type="text/javascript"></script>
<script src="/js/jquery.fancybox.js" type="text/javascript"></script><link rel="stylesheet" href="/css/jquery.fancybox.css" type="text/css"><script>var duoshuoQuery = {short_name:'crafteverywhere'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script></div></body></html>